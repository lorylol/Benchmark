// call Adlib.screenshotterEnd() on the last animation code.
// do not delete initAnimation function since this is the first function that will be called after initialization of defaultValues.
// if ever there is a video for this ad, you can use myVideo as the variable to play the video.
// sample tween codes:
// tween.to("#disclaimerWrapper", {opacity:0.99,duration: 1,ease: "power2.out"},"-=1");
// tween.set("#frame1HeadlineWrapper",{opacity:1})
let tween, h1, h2;
function remove_tags(html, withLine){
     var count = 0;
     if(withLine == true){
          html = html.replace(/(<|&lt;)br\s*\/*(>|&gt;)/g, function(){ count+=1;return "||br||"}); 
     } 
     var tmp = document.createElement("DIV");
     tmp.innerHTML = html;
     html = tmp.textContent||tmp.innerText;
     while(count > 0){
          html = html.replace("||br||","<br>");
          count--;
     }
     return html;
}

function className(elem, name) {
     var element, name, arr;
     element = document.getElementById(elem);
     name = name;
     arr = element.className.split(" ");
     if (arr.indexOf(name) == -1) {
       element.className += " " + name;
     }
}
function initAnimation() {
     if(defaultValues.fontName == "TUI Type"){
          className("headline1", "tuitype-bold");
          className("headline2", "tuitype-regular");
          className("icontext1", "tuitype-regular");
          className("icontext2", "tuitype-regular");
          className("icontext3", "tuitype-regular");
          className("headline4", "tuitype-bold");
          className("cta", "tuitype-regular");
     }else{
          className("headline1", "ambit-bold");
          className("headline2", "ambit-regular");
          className("icontext1", "ambit-regular");
          className("icontext2", "ambit-regular");
          className("icontext3", "ambit-regular");
          className("headline4", "ambit-bold");
          className("cta", "ambit-regular");
     }
     setTimeout(function(){
          tween = gsap.timeline();

          tween.set(".waves", {opacity:0}, 0);
          tween.set(".wave", {opacity:0}, 0);
          if(!Adlib.isEmpty(defaultValues.fontColor1)){
               tween.set("#headline1", {color: defaultValues.fontColor1}, 0);
          }
          if(!Adlib.isEmpty(defaultValues.fontColor2)){
               tween.set("#headline2", {color: defaultValues.fontColor2}, 0);
          }
          tween.set("#sublogoContainer", {opacity:0}, 0);
          tween.set("#ctaContent", {background: defaultValues.ctaColor1}, 0);
          if(!Adlib.isEmpty(defaultValues.ctaText) && defaultValues.trigger != "FRAME 1 AND 2 NO CTA"){
               tween.set("#ctaContainer", {opacity:0}, 0);
          }else{
               tween.set("#sublogoContent", {top:"220px"}, 0);
               if(Adlib.isEmpty(defaultValues.ctaText)){
                    tween.set("#ctaContainer", {display:"none", visibility:"hidden"}, 0);
               }else{
                    tween.set("#ctaContainer", {display:"none"}, 0);
               }   
          }
          tween.set("#termsContainer", {opacity:0}, 0);
          tween.set("#sublogo2Container", {opacity:0}, 0);
          tween.set("#logo2Content", {opacity:0}, 0);
          tween.set("#roundelContent", {opacity:0, scale: 0}, 0);
          tween.set("#headline4Container", {opacity:0}, 0);
          tween.set("#icontext1Container", {opacity:0}, 0);
          tween.set("#icontext2Container", {opacity:0}, 0);
          tween.set("#icontext3Container", {opacity:0}, 0);
          tween.set("#icon1Container", {opacity:0}, 0);
          tween.set("#icon2Container", {opacity:0}, 0);
          tween.set("#icon3Container", {opacity:0}, 0);
          tween.set("#mainContent", {opacity:1}, 0);

          tween.to(window, 0, {
               onStart: function(){
                    Adlib.textResize(); // This is optional if your build doesn't use text resize you can delete this
                    Adlib.templateCSS(defaultValues.cssAttrib); // DO NOT DELETE THIS       
                    h1 = new SplitText("#headline1", {type:"words,chars,lines"});
                    h2 = new SplitText("#headline2", {type:"words,chars,lines"});
          }, 
               onComplete: function(){
                    startAnimation();
          }}, "+=0");
     }, 1000);
}
function startAnimation() {  

     gsap.fromTo("#bgContent", {scale:1.1}, {ease: "none", scale: 1, duration: 10});
     // Call Waves
     waves();
     
     frame(1);

     frame(2);
     
     frame(3);
     
     frame(4);

     tween.to(window, 0, {onComplete: function(){
          animationEnd();
     }}, "+=0");
}
function frame(frame){
     switch(frame){
               case 1:
                    for(x = 0; x < h1.lines.length; x++){
                         if(x == 0){
                              tween.fromTo(h1.lines[x], {opacity: 0}, {ease: "none", opacity: 1, overflow:"visible", duration: .5}, "+=1");
                         }else{
                              tween.fromTo(h1.lines[x], {opacity: 0}, {ease: "none", opacity: 1, overflow:"visible", duration: .5}, "-=.3");
                         }
                    }

                    tween.to("#termsContainer", {ease: "none", opacity: 1, duration: .5}, "-=.3");

                    if(defaultValues.trigger == "FRAME 1 AND 2 WITH CTA"){
                         tween.to("#ctaContainer", {ease: "none", opacity: 1, duration: .5}, "+=0");
                         tween.to("#sublogoContainer", {ease: "none", opacity: 1, duration: .5}, "-=.3");
                    }else{
                         tween.to("#sublogoContainer", {ease: "none", opacity: 1, duration: .5}, "+=0");
                    }

                    tween.to(window, 0, {onComplete: function(){
                         takeScreenshot();
                    }}, "-=0");  
               
                    if(!Adlib.isEmpty(defaultValues.frame2Headline) ||
                    (!Adlib.isEmpty(defaultValues.frame3Headline) || 
                    !Adlib.isEmpty(defaultValues.frame3Headline2) || 
                    !Adlib.isEmpty(defaultValues.frame3Headline3)) ||
                    !Adlib.isEmpty(defaultValues.frame4Headline)){
                         for(x = h1.lines.length-1; x >= 0; x--){
                              if(x == h1.lines.length-1){
                                   tween.to(h1.lines[x], {ease: "none", opacity: 0, duration: .5}, "+=1");
                              }else{
                                   tween.to(h1.lines[x], {ease: "none", opacity: 0, duration: .5}, "-=.3");
                              }
                         }
                    }    
               break;

               case 2:
                    if(!Adlib.isEmpty(defaultValues.frame2Headline)){
                         for(x = 0; x < h2.lines.length; x++){
                              if(x == 0){
                                   tween.fromTo(h2.lines[x], {opacity: 0}, {ease: "none", opacity: 1, overflow:"visible", duration: .5}, "+=0");
                              }else{
                                   tween.fromTo(h2.lines[x], {opacity: 0}, {ease: "none", opacity: 1, overflow:"visible", duration: .5}, "-=.3");
                              }
                         }
                         
                         tween.to(window, 0, {onComplete: function(){
                              takeScreenshot();
                         }}, "-=0");  


                    }
                    if(!Adlib.isEmpty(defaultValues.frame3Headline) || 
                    !Adlib.isEmpty(defaultValues.frame3Headline2) || 
                    !Adlib.isEmpty(defaultValues.frame3Headline3) ||
                    !Adlib.isEmpty(defaultValues.frame4Headline)){
                         for(x = h2.lines.length-1; x >= 0; x--){
                              if(x == h2.lines.length-1){
                                   tween.to(h2.lines[x], {ease: "none", opacity: 0, duration: .5}, "+=1");
                              }else{
                                   tween.to(h2.lines[x], {ease: "none", opacity: 0, duration: .5}, "-=.3");
                              }
                         }

                         tween.to("#ctaContainer", {ease: "none", opacity: 0, duration: .5}, "+=0");
                         if(defaultValues.trigger == "FRAME 1 AND 2 WITH CTA"){
                              tween.to("#sublogoContainer", {ease: "none", opacity: 0, duration: .5}, "-=.5");
                         }
                         tween.to("#bgContainer", {ease: "none", opacity: 0, duration: .5}, "-=.5");
                         tween.to("#gradientContainer", {ease: "none", opacity: 0, duration: .5}, "-=.5");
                    }
               break;

               case 3:
                    if(!Adlib.isEmpty(defaultValues.frame3Headline) || 
                    !Adlib.isEmpty(defaultValues.frame3Headline2) || 
                    !Adlib.isEmpty(defaultValues.frame3Headline3)){
                         tween.fromTo("#ctaContainer", {opacity: 0}, {ease: "none", opacity: 1, display:"initial", duration: .5, onStart: function(){
                              gsap.set("#ctaContent", {top:"190px", left:"102px"})
                         }}, "+=0");
                         tween.to("#sublogoContainer", {ease: "none", opacity: 1, duration: .5, onStart: function(){
                              gsap.set("#sublogoContent", {top:"220px"})
                         }}, "-=.5");
                         tween.to("#sublogo2Container", {ease: "none", opacity: 1, duration: .8}, "-=.5");

                         tween.fromTo("#icontext1Container", {opacity: 0, y: -30}, {ease: "none", opacity: 1, y: 0, duration: .5, onStart: function(){
                              gsap.fromTo("#icon1Container", {opacity: 0, y: -30}, {ease: "none", opacity: 1, y: 0, duration: .5});
                         }}, "-=.5");
                         tween.fromTo("#icontext2Container", {opacity: 0, y: -30}, {ease: "none", opacity: 1, y: 0, duration: .5, onStart: function(){
                              gsap.fromTo("#icon2Container", {opacity: 0, y: -30}, {ease: "none", opacity: 1, y: 0, duration: .5});
                         }}, "-=.3");
                         tween.fromTo("#icontext3Container", {opacity: 0, y: -30}, {ease: "none", opacity: 1, y: 0, duration: .5, onStart: function(){
                              gsap.fromTo("#icon3Container", {opacity: 0, y: -30}, {ease: "none", opacity: 1, y: 0, duration: .5});
                         }}, "-=.1");

                         tween.to(window, 0, {onComplete: function(){
                              takeScreenshot();
                         }}, "-=0");  

                         if(!Adlib.isEmpty(defaultValues.frame4Headline)){
                              tween.to("#icontext1Container", {ease: "none", opacity: 0, y: -30, duration: .5, onStart: function(){
                                   gsap.to("#icon1Container", {ease: "none", opacity: 0, y: -30, duration: .5});
                              }}, "+=2");
                              tween.to("#icontext2Container", {ease: "none", opacity: 0, y: -30, duration: .5, onStart: function(){
                                   gsap.to("#icon2Container", {ease: "none", opacity: 0, y: -30, duration: .5});
                              }}, "-=.3");
                              tween.to("#icontext3Container", {ease: "none", opacity: 0, y: -30, duration: .5, onStart: function(){
                                   gsap.to("#icon3Container", {ease: "none", opacity: 0, y: -30, duration: .5});
                              }}, "-=.1");
                         }
                    }else{
                         if(!Adlib.isEmpty(defaultValues.frame4Headline)){
                              tween.fromTo("#ctaContainer", {opacity: 0}, {ease: "none", opacity: 1, display:"initial", duration: .5, onStart: function(){
                                   gsap.set("#ctaContent", {top:"190px", left:"102px"})
                              }}, "+=0");
                              tween.fromTo("#sublogoContainer", {opacity: 0}, {ease: "none", opacity: 1, duration: .5, onStart: function(){
                                   gsap.set("#sublogoContent", {top:"220px", left:"181px"})
                              }}, "-=.5");
                              tween.to("#sublogo2Container", {ease: "none", opacity: 1, duration: .8}, "-=.5");
                         }
                    }
               break;
               case 4:
                    if(!Adlib.isEmpty(defaultValues.frame4Headline)){
                         tween.fromTo("#headline4Container", {opacity: 0, y:-30}, {ease: "none", opacity: 1, y: 0, duration: .5}, "+=0");
                         tween.to("#roundelContent", {ease: "none", opacity: 1, scale: 1, duration: .5}, "-=.5");

                         tween.to("#ctaContent", {ease: "none", scale: 1.2, duration: .2}, "+=0");
                         tween.to("#ctaContent", {ease: "none", scale: 1, duration: .2}, "-=0");

                         tween.to(window, 0, {onComplete: function(){
                              takeScreenshot();
                         }}, "-=0");
                    }
               break;
               
     }
}
function waves(){
     var waves1 = gsap.timeline();
     var waves2 = gsap.timeline({paused: true});
     var waves3 = gsap.timeline({paused: true});
     var waves4 = gsap.timeline({paused: true});
     var waves5 = gsap.timeline({paused: true});
     var waves6 = gsap.timeline({paused: true});
     var waves7 = gsap.timeline({paused: true});
     var waves8 = gsap.timeline({paused: true});
     var finalwave1 = gsap.timeline({paused: true});
     var finalwave2 = gsap.timeline({paused: true});
     var finalwave3 = gsap.timeline({paused: true});
     var speed1 = .5;
     var speed2 = 1.0;
     var speed3 = .5;
     var waveDelay = 500;

     waves1.fromTo("#waving1", {x: 30, y: -30, opacity: 0}, {duration: speed1, ease: "none", x: 25, y: -25, opacity: 1})
     .to("#waving1", speed2, {ease: "none", x: 8, y: -8, opacity: 1, onStart: function(){ setTimeout(function(){waves2.resume()}, waveDelay) }})
     .to("#waving1", speed3, {ease: "none", x: 0, y: 0, opacity: 0});

     waves2.fromTo("#waving2", {x: 30, y: -30, opacity: 0}, {duration: speed1, ease: "none", x: 25, y: -25, opacity: 1})
     .to("#waving2", speed2, {ease: "none", x: 8, y: -8, opacity: 1, onStart: function(){ setTimeout(function(){waves3.resume()}, waveDelay) }})
     .to("#waving2", speed3, {ease: "none", x: 0, y: 0, opacity: 0});

     waves3.fromTo("#waving3", {x: 30, y: -30, opacity: 0}, {duration: speed1, ease: "none", x: 25, y: -25, opacity: 1})
     .to("#waving3", speed2, {ease: "none", x: 8, y: -8, opacity: 1, onStart: function(){ setTimeout(function(){waves4.resume()}, waveDelay) }})
     .to("#waving3", speed3, {ease: "none", x: 0, y: 0, opacity: 0});

     waves4.fromTo("#waving4", {x: 30, y: -30, opacity: 0}, {duration: speed1, ease: "none", x: 25, y: -25, opacity: 1})
     .to("#waving4", speed2, {ease: "none", x: 8, y: -8, opacity: 1, onStart: function(){ setTimeout(function(){waves5.resume()}, waveDelay) }})
     .to("#waving4", speed3, {ease: "none", x: 0, y: 0, opacity: 0});

     waves5.fromTo("#waving5", {x: 30, y: -30, opacity: 0}, {duration: speed1, ease: "none", x: 25, y: -25, opacity: 1})
     .to("#waving5", speed2, {ease: "none", x: 8, y: -8, opacity: 1, onStart: function(){ setTimeout(function(){waves6.resume()}, waveDelay) }})
     .to("#waving5", speed3, {ease: "none", x: 0, y: 0, opacity: 0});

     waves6.fromTo("#waving6", {x: 30, y: -30, opacity: 0}, {duration: speed1, ease: "none", x: 25, y: -25, opacity: 1})
     .to("#waving6", speed2, {ease: "none", x: 8, y: -8, opacity: 1, onStart: function(){ setTimeout(function(){waves7.resume()}, waveDelay) }})
     .to("#waving6", speed3, {ease: "none", x: 0, y: 0, opacity: 0});

     waves7.fromTo("#waving7", {x: 30, y: -30, opacity: 0}, {duration: speed1, ease: "none", x: 25, y: -25, opacity: 1})
     .to("#waving7", speed2, {ease: "none", x: 8, y: -8, opacity: 1, onStart: function(){ setTimeout(function(){waves8.resume()}, waveDelay) }})
     .to("#waving7", speed3, {ease: "none", x: 0, y: 0, opacity: 0});

     waves8.fromTo("#waving8", {x: 30, y: -30, opacity: 0}, {duration: speed1, ease: "none", x: 25, y: -25, opacity: 1})
     .to("#waving8", speed2, {ease: "none", x: 8, y: -8, opacity: 1, onStart: function(){ setTimeout(function(){finalwave1.resume()}, waveDelay) }})
     .to("#waving8", speed3, {ease: "none", x: 0, y: 0, opacity: 0});

     finalwave1.fromTo("#wave3", {x: 30, y: -30, opacity: 0}, {duration: speed1, ease: "none", x: 25, y: -25, opacity: 1})
     .to("#wave3", speed2, {ease: "none", x: 8, y: -8, opacity: 1, onStart: function(){ setTimeout(function(){finalwave2.resume()}, waveDelay) }})
     .to("#wave3", speed3, {ease: "none", x: 0, y: 0});

     finalwave2.fromTo("#wave2", {x: 30, y: -30, opacity: 0}, {duration: speed1, ease: "none", x: 25, y: -25, opacity: 1})
     .to("#wave2", speed3, {ease: "none", x: 14, y: -14, opacity: 1, onStart: function(){ finalwave3.resume() }});

     finalwave3.fromTo("#wave1", {x: 30, y: -30, opacity: 0}, {duration: speed2, ease: "none", x: 30, y: -30, opacity: 1, onStart: function(){
          if(!Adlib.isEmpty(defaultValues.customVariable) && defaultValues.customVariable != "0"){
               gsap.to("#logoContent", {ease: "none", opacity: 0, y: 8, duration: .5});
               gsap.to("#logo2Content", {ease: "none", opacity: 1, y: 8, duration: .5});
          }
     }});
}
function animationEnd() {
     // call this function on the very end of the last animation.     
     takeScreenshot();
     setTimeout(function() {adlibEnd();},1000);
}